Chapter 4, modified in experimental branch, another modification in chapter 4 using experimental branch